// Auto-generated by DeltaPack - do not edit
using System.Linq;

namespace Generated.Examples
{
    public class Primitives
    {
        public string StringField { get; set; } = "";
        public long SignedIntField { get; set; }
        public long UnsignedIntField { get; set; }
        public float FloatField { get; set; }
        public bool BooleanField { get; set; }

        public static Primitives Default() => new();

        public static Primitives FromJson(System.Text.Json.JsonElement json)
        {
            return new()
            {
                StringField = DeltaPack.JsonHelpers.ParseString(json.GetProperty("stringField")),
                SignedIntField = json.GetProperty("signedIntField").GetInt64(),
                UnsignedIntField = json.GetProperty("unsignedIntField").GetInt64(),
                FloatField = json.GetProperty("floatField").GetSingle(),
                BooleanField = DeltaPack.JsonHelpers.ParseBoolean(json.GetProperty("booleanField")),
            };
        }

        public static System.Text.Json.Nodes.JsonObject ToJson(Primitives obj)
        {
            var result = new System.Text.Json.Nodes.JsonObject();
            result["stringField"] = obj.StringField;
            result["signedIntField"] = obj.SignedIntField;
            result["unsignedIntField"] = obj.UnsignedIntField;
            result["floatField"] = obj.FloatField;
            result["booleanField"] = obj.BooleanField;
            return result;
        }

        public static Primitives Clone(Primitives obj)
        {
            return new()
            {
                StringField = obj.StringField,
                SignedIntField = obj.SignedIntField,
                UnsignedIntField = obj.UnsignedIntField,
                FloatField = obj.FloatField,
                BooleanField = obj.BooleanField,
            };
        }

        public static bool Equals(Primitives a, Primitives b)
        {
            return a.StringField == b.StringField &&
                a.SignedIntField == b.SignedIntField &&
                a.UnsignedIntField == b.UnsignedIntField &&
                DeltaPack.EqualityHelpers.EqualsFloat(a.FloatField, b.FloatField) &&
                a.BooleanField == b.BooleanField;
        }

        public static byte[] Encode(Primitives obj)
        {
            var encoder = new DeltaPack.Encoder();
            Encode_(obj, encoder);
            return encoder.ToBuffer();
        }

        internal static void Encode_(Primitives obj, DeltaPack.Encoder encoder)
        {
            encoder.PushString(obj.StringField);
            encoder.PushInt(obj.SignedIntField);
            encoder.PushBoundedInt(obj.UnsignedIntField, 0);
            encoder.PushFloat(obj.FloatField);
            encoder.PushBoolean(obj.BooleanField);
        }

        public static byte[] EncodeDiff(Primitives a, Primitives b)
        {
            var encoder = new DeltaPack.Encoder();
            EncodeDiff_(a, b, encoder);
            return encoder.ToBuffer();
        }

        internal static void EncodeDiff_(Primitives a, Primitives b, DeltaPack.Encoder encoder)
        {
            var changed = !Equals(a, b);
            encoder.PushBoolean(changed);
            if (!changed) return;
            EncodeDiffFields_(a, b, encoder);
        }

        internal static void EncodeDiffFields_(Primitives a, Primitives b, DeltaPack.Encoder encoder)
        {
            {
                var changed = !(a.StringField == b.StringField);
                encoder.PushBoolean(changed);
                if (changed) encoder.PushStringDiff(a.StringField, b.StringField);
            }
            {
                var changed = !(a.SignedIntField == b.SignedIntField);
                encoder.PushBoolean(changed);
                if (changed) encoder.PushIntDiff(a.SignedIntField, b.SignedIntField);
            }
            {
                var changed = !(a.UnsignedIntField == b.UnsignedIntField);
                encoder.PushBoolean(changed);
                if (changed) encoder.PushBoundedIntDiff(a.UnsignedIntField, b.UnsignedIntField, 0);
            }
            {
                var changed = !(DeltaPack.EqualityHelpers.EqualsFloat(a.FloatField, b.FloatField));
                encoder.PushBoolean(changed);
                if (changed) encoder.PushFloatDiff(a.FloatField, b.FloatField);
            }
            encoder.PushBooleanDiff(a.BooleanField, b.BooleanField);
        }

        public static Primitives Decode(byte[] buf)
        {
            var decoder = new DeltaPack.Decoder(buf);
            return Decode_(decoder);
        }

        internal static Primitives Decode_(DeltaPack.Decoder decoder)
        {
            return new()
            {
                StringField = decoder.NextString(),
                SignedIntField = decoder.NextInt(),
                UnsignedIntField = decoder.NextBoundedInt(0),
                FloatField = decoder.NextFloat(),
                BooleanField = decoder.NextBoolean(),
            };
        }

        public static Primitives DecodeDiff(Primitives obj, byte[] diff)
        {
            var decoder = new DeltaPack.Decoder(diff);
            return DecodeDiff_(obj, decoder);
        }

        internal static Primitives DecodeDiff_(Primitives obj, DeltaPack.Decoder decoder)
        {
            var changed = decoder.NextBoolean();
            if (!changed) return obj;
            return DecodeDiffFields_(obj, decoder);
        }

        internal static Primitives DecodeDiffFields_(Primitives obj, DeltaPack.Decoder decoder)
        {
            return new()
            {
                StringField = decoder.NextFieldDiff(obj.StringField, x => decoder.NextStringDiff(x)),
                SignedIntField = decoder.NextFieldDiff(obj.SignedIntField, x => decoder.NextIntDiff(x)),
                UnsignedIntField = decoder.NextFieldDiff(obj.UnsignedIntField, x => decoder.NextBoundedIntDiff(x, 0)),
                FloatField = decoder.NextFieldDiff(obj.FloatField, x => decoder.NextFloatDiff(x)),
                BooleanField = decoder.NextBooleanDiff(obj.BooleanField),
            };
        }
    }
}
