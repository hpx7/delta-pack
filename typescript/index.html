<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Delta-Pack - v0.2.8</title><meta name="description" content="Documentation for Delta-Pack"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">Delta-Pack - v0.2.8</a><div id="tsd-toolbar-links"><a href="https://github.com/hpx7/delta-pack">GitHub</a></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>Delta-Pack - v0.2.8</h1></div><div class="tsd-panel tsd-typography"><h1 id="delta-pack-typescript" class="tsd-anchor-link">Delta-Pack TypeScript<a href="#delta-pack-typescript" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>TypeScript implementation of delta-pack, a compact binary serialization format with efficient delta compression for real-time state synchronization.</p>
<h2 id="installation" class="tsd-anchor-link">Installation<a href="#installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@hpx7/delta-pack</span>
</code><button type="button">Copy</button></pre>

<h2 id="quick-start" class="tsd-anchor-link">Quick Start<a href="#quick-start" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Delta-pack provides three approaches for working with schemas:</p>
<ol>
<li><strong>Interpreter Mode</strong> - Runtime schema parsing with dynamic API</li>
<li><strong>Decorator Mode</strong> - Use TypeScript decorators for class-based schemas (builds on interpreter mode)</li>
<li><strong>Codegen Mode</strong> - Generate TypeScript code from schemas for compile-time type safety</li>
</ol>
<h3 id="interpreter-mode-recommended-for-prototyping" class="tsd-anchor-link">Interpreter Mode (Recommended for prototyping)<a href="#interpreter-mode-recommended-for-prototyping" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">ObjectType</span><span class="hl-1">, </span><span class="hl-4">StringType</span><span class="hl-1">, </span><span class="hl-4">IntType</span><span class="hl-1">, </span><span class="hl-4">load</span><span class="hl-1">, </span><span class="hl-4">Infer</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Define schema type directly</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Player</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;Player&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-0">StringType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-0">StringType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-0">IntType</span><span class="hl-1">(),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Infer TypeScript type</span><br/><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-8">Player</span><span class="hl-1"> = </span><span class="hl-8">Infer</span><span class="hl-1">&lt;</span><span class="hl-6">typeof</span><span class="hl-1"> </span><span class="hl-4">Player</span><span class="hl-1">&gt;;</span><br/><span class="hl-5">// Result: { id: string; name: string; score: number }</span><br/><br/><span class="hl-5">// Load API for the type</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">PlayerApi</span><span class="hl-1"> = </span><span class="hl-0">load</span><span class="hl-1">(</span><span class="hl-4">Player</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Use the API</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1"> = { </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">, </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1"> };</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">encoded</span><span class="hl-1"> = </span><span class="hl-4">PlayerApi</span><span class="hl-1">.</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-4">player</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">decoded</span><span class="hl-1"> = </span><span class="hl-4">PlayerApi</span><span class="hl-1">.</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-4">encoded</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h3 id="decorator-mode-recommended-for-class-based-code" class="tsd-anchor-link">Decorator Mode (Recommended for class-based code)<a href="#decorator-mode-recommended-for-class-based-code" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">StringType</span><span class="hl-1">, </span><span class="hl-4">IntType</span><span class="hl-1">, </span><span class="hl-4">loadClass</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">Player</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">StringType</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-4">id</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> = </span><span class="hl-2">&quot;&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  @</span><span class="hl-0">StringType</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> = </span><span class="hl-2">&quot;&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  @</span><span class="hl-0">IntType</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-4">score</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Load API from decorated class</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">PlayerApi</span><span class="hl-1"> = </span><span class="hl-0">loadClass</span><span class="hl-1">(</span><span class="hl-4">Player</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Use the API</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Player</span><span class="hl-1">();</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1"> = </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">name</span><span class="hl-1"> = </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">score</span><span class="hl-1"> = </span><span class="hl-9">100</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">encoded</span><span class="hl-1"> = </span><span class="hl-4">PlayerApi</span><span class="hl-1">.</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-4">player</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">decoded</span><span class="hl-1"> = </span><span class="hl-4">PlayerApi</span><span class="hl-1">.</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-4">encoded</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h3 id="codegen-mode-recommended-for-production" class="tsd-anchor-link">Codegen Mode (Recommended for production)<a href="#codegen-mode-recommended-for-production" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Create a YAML schema file (<code>schema.yml</code>):</p>
<pre><code class="yaml"><span class="hl-5"># yaml-language-server: $schema=https://raw.githubusercontent.com/hpx7/delta-pack/refs/heads/main/schema.json</span><br/><br/><span class="hl-10">Player</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-10">id</span><span class="hl-1">: </span><span class="hl-11">string</span><br/><span class="hl-1">  </span><span class="hl-10">name</span><span class="hl-1">: </span><span class="hl-11">string</span><br/><span class="hl-1">  </span><span class="hl-10">score</span><span class="hl-1">: </span><span class="hl-11">int</span>
</code><button type="button">Copy</button></pre>

<p>Generate TypeScript code using the CLI:</p>
<pre><code class="bash"><span class="hl-0">npx</span><span class="hl-1"> </span><span class="hl-2">delta-pack</span><span class="hl-1"> </span><span class="hl-2">generate</span><span class="hl-1"> </span><span class="hl-2">schema.yml</span><span class="hl-1"> </span><span class="hl-6">-l</span><span class="hl-1"> </span><span class="hl-2">typescript</span><span class="hl-1"> </span><span class="hl-6">-o</span><span class="hl-1"> </span><span class="hl-2">generated.ts</span>
</code><button type="button">Copy</button></pre>

<p>Then use the generated code:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Player</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./generated&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1">: </span><span class="hl-8">Player</span><span class="hl-1"> = { </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">, </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1"> };</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">encoded</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-4">player</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">decoded</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-4">encoded</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h2 id="schema-definition" class="tsd-anchor-link">Schema Definition<a href="#schema-definition" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Schemas can be defined in two ways:</p>
<ol>
<li><strong>YAML</strong> - Human-readable format, useful for defining schemas separately from code. Parse with <code>parseSchemaYml()</code> for interpreter mode.</li>
<li><strong>TypeScript</strong> - Define schemas using the type constructor functions. Works with both interpreter and codegen modes. Required for using the <code>Infer&lt;&gt;</code> type utility.</li>
</ol>
<p><strong>Note:</strong> The <code>Infer&lt;&gt;</code> type utility only works with TypeScript-defined schemas, not YAML-parsed schemas, since it requires compile-time type information.</p>
<h3 id="yaml-schema" class="tsd-anchor-link">YAML Schema<a href="#yaml-schema" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Create a <code>schema.yml</code> file:</p>
<pre><code class="yaml"><span class="hl-5"># yaml-language-server: $schema=https://raw.githubusercontent.com/hpx7/delta-pack/refs/heads/main/schema.json</span><br/><br/><span class="hl-5"># Enums (list of string literals)</span><br/><span class="hl-10">Team</span><span class="hl-1">:</span><br/><span class="hl-1">  - </span><span class="hl-11">RED</span><br/><span class="hl-1">  - </span><span class="hl-11">BLUE</span><br/><br/><span class="hl-5"># Objects</span><br/><span class="hl-10">Player</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-10">id</span><span class="hl-1">: </span><span class="hl-11">string</span><br/><span class="hl-1">  </span><span class="hl-10">name</span><span class="hl-1">: </span><span class="hl-11">string</span><br/><span class="hl-1">  </span><span class="hl-10">score</span><span class="hl-1">: </span><span class="hl-11">int</span><br/><span class="hl-1">  </span><span class="hl-10">team</span><span class="hl-1">: </span><span class="hl-11">Team</span><br/><span class="hl-1">  </span><span class="hl-10">position</span><span class="hl-1">: </span><span class="hl-11">Position?</span><br/><br/><span class="hl-10">Position</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-10">x</span><span class="hl-1">: </span><span class="hl-11">float(precision=0.1)</span><br/><span class="hl-1">  </span><span class="hl-6">y</span><span class="hl-1">: </span><span class="hl-11">float(precision=0.1)</span><br/><br/><span class="hl-5"># Union types (list of type references)</span><br/><span class="hl-5"># A union is a list where all items are defined type names</span><br/><span class="hl-10">MoveAction</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-10">x</span><span class="hl-1">: </span><span class="hl-11">int</span><br/><span class="hl-1">  </span><span class="hl-6">y</span><span class="hl-1">: </span><span class="hl-11">int</span><br/><br/><span class="hl-10">AttackAction</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-10">targetId</span><span class="hl-1">: </span><span class="hl-11">string</span><br/><span class="hl-1">  </span><span class="hl-10">damage</span><span class="hl-1">: </span><span class="hl-11">uint</span><span class="hl-1"> </span><span class="hl-5"># shorthand for int(min=0)</span><br/><br/><span class="hl-10">GameAction</span><span class="hl-1">:</span><br/><span class="hl-1">  - </span><span class="hl-11">MoveAction</span><br/><span class="hl-1">  - </span><span class="hl-11">AttackAction</span><br/><br/><span class="hl-5"># Complex types</span><br/><span class="hl-10">GameState</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-10">players</span><span class="hl-1">: </span><span class="hl-11">&lt;string, Player&gt;</span><br/><span class="hl-1">  </span><span class="hl-10">actions</span><span class="hl-1">: </span><span class="hl-11">GameAction[]</span><br/><span class="hl-1">  </span><span class="hl-10">round</span><span class="hl-1">: </span><span class="hl-11">uint</span><br/><span class="hl-1">  </span><span class="hl-10">phase</span><span class="hl-1">: </span><span class="hl-11">string</span><br/><br/><span class="hl-5"># Bounded integers</span><br/><span class="hl-10">BoundedExample</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-10">health</span><span class="hl-1">: </span><span class="hl-11">int(min=0, max=100)</span><span class="hl-1"> </span><span class="hl-5"># validated in fromJson, encoded as unsigned</span><br/><span class="hl-1">  </span><span class="hl-10">level</span><span class="hl-1">: </span><span class="hl-11">int(min=1, max=99)</span><br/><span class="hl-1">  </span><span class="hl-10">temperature</span><span class="hl-1">: </span><span class="hl-11">int(min=-50, max=50)</span>
</code><button type="button">Copy</button></pre>

<p>Parse YAML schemas with:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">parseSchemaYml</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">readFileSync</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;fs&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">schemaYml</span><span class="hl-1"> = </span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-2">&quot;schema.yml&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;utf8&quot;</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">schema</span><span class="hl-1"> = </span><span class="hl-0">parseSchemaYml</span><span class="hl-1">(</span><span class="hl-4">schemaYml</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>See the <a href="media/README.md">main README</a> for complete schema syntax reference.</p>
<h3 id="typescript-schema" class="tsd-anchor-link">TypeScript Schema<a href="#typescript-schema" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Define schemas using the type constructor functions. Named types (<code>ObjectType</code>, <code>EnumType</code>, <code>UnionType</code>) take a required name as the first parameter:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">ObjectType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">StringType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">IntType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">UIntType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">FloatType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">ArrayType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">OptionalType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">RecordType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">EnumType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">UnionType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">ReferenceType</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Enum type</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Team</span><span class="hl-1"> = </span><span class="hl-0">EnumType</span><span class="hl-1">(</span><span class="hl-2">&quot;Team&quot;</span><span class="hl-1">, [</span><span class="hl-2">&quot;RED&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;BLUE&quot;</span><span class="hl-1">]);</span><br/><br/><span class="hl-5">// Object types - define in dependency order</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Position</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;Position&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-0">FloatType</span><span class="hl-1">({ </span><span class="hl-4">precision:</span><span class="hl-1"> </span><span class="hl-9">0.1</span><span class="hl-1"> }),</span><br/><span class="hl-1">  </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-0">FloatType</span><span class="hl-1">({ </span><span class="hl-4">precision:</span><span class="hl-1"> </span><span class="hl-9">0.1</span><span class="hl-1"> }),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Player</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;Player&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-0">StringType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-0">StringType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-0">IntType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">team:</span><span class="hl-1"> </span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Team</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-0">OptionalType</span><span class="hl-1">(</span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Position</span><span class="hl-1">)),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Union type - options are direct type references</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">MoveAction</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;MoveAction&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-0">IntType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-0">IntType</span><span class="hl-1">(),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">AttackAction</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;AttackAction&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">targetId:</span><span class="hl-1"> </span><span class="hl-0">StringType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">damage:</span><span class="hl-1"> </span><span class="hl-0">UIntType</span><span class="hl-1">(),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">GameAction</span><span class="hl-1"> = </span><span class="hl-0">UnionType</span><span class="hl-1">(</span><span class="hl-2">&quot;GameAction&quot;</span><span class="hl-1">, [</span><span class="hl-4">MoveAction</span><span class="hl-1">, </span><span class="hl-4">AttackAction</span><span class="hl-1">]);</span><br/><br/><span class="hl-5">// Using unions in other types</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">GameState</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;GameState&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">players:</span><span class="hl-1"> </span><span class="hl-0">RecordType</span><span class="hl-1">(</span><span class="hl-0">StringType</span><span class="hl-1">(), </span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Player</span><span class="hl-1">)),</span><br/><span class="hl-1">  </span><span class="hl-4">actions:</span><span class="hl-1"> </span><span class="hl-0">ArrayType</span><span class="hl-1">(</span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">GameAction</span><span class="hl-1">)),</span><br/><span class="hl-1">  </span><span class="hl-4">round:</span><span class="hl-1"> </span><span class="hl-0">UIntType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">phase:</span><span class="hl-1"> </span><span class="hl-0">StringType</span><span class="hl-1">(),</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Union value format:</strong> Union values use a flattened discriminated union format with <code>_type</code>:</p>
<pre><code class="typescript"><span class="hl-5">// Creating a union value</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">action</span><span class="hl-1">: </span><span class="hl-8">GameAction</span><span class="hl-1"> = { </span><span class="hl-4">_type:</span><span class="hl-1"> </span><span class="hl-2">&quot;MoveAction&quot;</span><span class="hl-1">, </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-9">10</span><span class="hl-1">, </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-9">20</span><span class="hl-1"> };</span><br/><br/><span class="hl-5">// Type narrowing with discriminant</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">action</span><span class="hl-1">.</span><span class="hl-4">_type</span><span class="hl-1"> === </span><span class="hl-2">&quot;MoveAction&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">action</span><span class="hl-1">.</span><span class="hl-4">x</span><span class="hl-1">, </span><span class="hl-4">action</span><span class="hl-1">.</span><span class="hl-4">y</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h2 id="interpreter-api" class="tsd-anchor-link">Interpreter API<a href="#interpreter-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The interpreter mode provides a runtime API for working with schemas.</p>
<h3 id="loading-a-schema" class="tsd-anchor-link">Loading a Schema<a href="#loading-a-schema" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">ObjectType</span><span class="hl-1">, </span><span class="hl-4">StringType</span><span class="hl-1">, </span><span class="hl-4">IntType</span><span class="hl-1">, </span><span class="hl-4">load</span><span class="hl-1">, </span><span class="hl-4">Infer</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Define schema type</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Player</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;Player&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-0">StringType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-0">StringType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-0">IntType</span><span class="hl-1">(),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Infer TypeScript type</span><br/><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-8">Player</span><span class="hl-1"> = </span><span class="hl-8">Infer</span><span class="hl-1">&lt;</span><span class="hl-6">typeof</span><span class="hl-1"> </span><span class="hl-4">Player</span><span class="hl-1">&gt;;</span><br/><span class="hl-5">// Result: { id: string; name: string; score: number }</span><br/><br/><span class="hl-5">// Load interpreter API</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">PlayerApi</span><span class="hl-1"> = </span><span class="hl-0">load</span><span class="hl-1">(</span><span class="hl-4">Player</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h3 id="api-methods" class="tsd-anchor-link">API Methods<a href="#api-methods" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Every loaded type provides these methods:</p>
<h4 id="" class="tsd-anchor-link"><code>fromJson(obj: Record&lt;string, unknown&gt;): T</code></h4><p>Validates and parses JSON data, throwing if invalid. Use this when parsing untrusted or untyped data:</p>
<pre><code class="typescript"><span class="hl-5">// Parse unvalidated JSON data</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">jsonData</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-0">parse</span><span class="hl-1">(</span><span class="hl-4">networkResponse</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">fromJson</span><span class="hl-1">(</span><span class="hl-4">jsonData</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>For most cases, prefer using TypeScript types directly:</p>
<pre><code class="typescript"><span class="hl-5">// Preferred: use TypeScript types for compile-time safety</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1">: </span><span class="hl-8">Player</span><span class="hl-1"> = { </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">, </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1"> };</span>
</code><button type="button">Copy</button></pre>

<h4 id="-1" class="tsd-anchor-link"><code>toJson(obj: T): Record&lt;string, unknown&gt;</code><a href="#-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Converts an object to JSON-serializable format. Useful for serializing to JSON or sending over HTTP:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1">: </span><span class="hl-8">Player</span><span class="hl-1"> = { </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">, </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1"> };</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">json</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">toJson</span><span class="hl-1">(</span><span class="hl-4">player</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">jsonString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-0">stringify</span><span class="hl-1">(</span><span class="hl-4">json</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Format notes:</strong></p>
<ul>
<li>Maps (RecordType) are converted to plain objects</li>
<li>Optional object properties with <code>undefined</code> values are excluded from the JSON</li>
<li>Unions are converted to protobuf format: <code>{ TypeName: {...} }</code></li>
</ul>
<p><strong>Example with unions:</strong></p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">action</span><span class="hl-1">: </span><span class="hl-8">GameAction</span><span class="hl-1"> = { </span><span class="hl-4">_type:</span><span class="hl-1"> </span><span class="hl-2">&quot;MoveAction&quot;</span><span class="hl-1">, </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-9">10</span><span class="hl-1">, </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-9">20</span><span class="hl-1"> };</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">json</span><span class="hl-1"> = </span><span class="hl-4">GameAction</span><span class="hl-1">.</span><span class="hl-0">toJson</span><span class="hl-1">(</span><span class="hl-4">action</span><span class="hl-1">);</span><br/><span class="hl-5">// Result: { MoveAction: { x: 10, y: 20 } }</span>
</code><button type="button">Copy</button></pre>

<p>The JSON output uses protobuf format (<code>{ TypeName: {...} }</code>) which can be parsed back with <code>fromJson()</code>.</p>
<h4 id="-2" class="tsd-anchor-link"><code>encode(obj: T): Uint8Array</code><a href="#-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Serializes an object to binary format:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1"> = { </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">, </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1"> };</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">bytes</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-4">player</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Encoded size: </span><span class="hl-6">${</span><span class="hl-4">bytes</span><span class="hl-12">.</span><span class="hl-4">length</span><span class="hl-6">}</span><span class="hl-2"> bytes`</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h4 id="-3" class="tsd-anchor-link"><code>decode(bytes: Uint8Array): T</code><a href="#-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Deserializes binary data back to an object:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">decoded</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-4">bytes</span><span class="hl-1">);</span><br/><span class="hl-5">// decoded = { id: &#39;p1&#39;, name: &#39;Alice&#39;, score: 100 }</span>
</code><button type="button">Copy</button></pre>

<h4 id="-4" class="tsd-anchor-link"><code>encodeDiff(oldObj: T, newObj: T): Uint8Array</code><a href="#-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Encodes only the differences between two objects:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">oldPlayer</span><span class="hl-1"> = { </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">, </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1"> };</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">newPlayer</span><span class="hl-1"> = { </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">, </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">150</span><span class="hl-1"> };</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">diff</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">encodeDiff</span><span class="hl-1">(</span><span class="hl-4">oldPlayer</span><span class="hl-1">, </span><span class="hl-4">newPlayer</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Diff size: </span><span class="hl-6">${</span><span class="hl-4">diff</span><span class="hl-12">.</span><span class="hl-4">length</span><span class="hl-6">}</span><span class="hl-2"> bytes`</span><span class="hl-1">); </span><span class="hl-5">// Much smaller!</span>
</code><button type="button">Copy</button></pre>

<h4 id="-5" class="tsd-anchor-link"><code>decodeDiff(oldObj: T, diffBytes: Uint8Array): T</code><a href="#-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Applies a diff to reconstruct the new object:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">reconstructed</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">decodeDiff</span><span class="hl-1">(</span><span class="hl-4">oldPlayer</span><span class="hl-1">, </span><span class="hl-4">diff</span><span class="hl-1">);</span><br/><span class="hl-5">// reconstructed = { id: &#39;p1&#39;, name: &#39;Alice&#39;, score: 150 }</span>
</code><button type="button">Copy</button></pre>

<h4 id="-6" class="tsd-anchor-link"><code>equals(a: T, b: T): boolean</code><a href="#-6" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Deep equality comparison with appropriate tolerance for floats:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">isEqual</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">equals</span><span class="hl-1">(</span><span class="hl-4">player1</span><span class="hl-1">, </span><span class="hl-4">player2</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>For quantized floats (with <code>precision</code>), equality uses quantized value comparison. For non-quantized floats, equality uses epsilon-based comparison (0.00001 tolerance).</p>
<h4 id="-7" class="tsd-anchor-link"><code>clone(obj: T): T</code><a href="#-7" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Creates a deep clone of an object:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player1</span><span class="hl-1"> = { </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">, </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1"> };</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player2</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">clone</span><span class="hl-1">(</span><span class="hl-4">player1</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Modifying the clone doesn&#39;t affect the original</span><br/><span class="hl-4">player2</span><span class="hl-1">.</span><span class="hl-4">score</span><span class="hl-1"> = </span><span class="hl-9">200</span><span class="hl-1">;</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">player1</span><span class="hl-1">.</span><span class="hl-4">score</span><span class="hl-1">); </span><span class="hl-5">// 100</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">player2</span><span class="hl-1">.</span><span class="hl-4">score</span><span class="hl-1">); </span><span class="hl-5">// 200</span>
</code><button type="button">Copy</button></pre>

<p><strong>Important notes:</strong></p>
<ul>
<li>Creates deep copies of all nested objects, arrays, and maps</li>
<li>Primitives (strings, numbers, booleans) are copied by value</li>
<li>The <code>_dirty</code> field is <strong>not</strong> preserved in clones (clones always start clean)</li>
<li>Useful for creating modified copies without mutating the original state</li>
</ul>
<h2 id="decorator-api" class="tsd-anchor-link">Decorator API<a href="#decorator-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The decorator mode provides a class-based API using TypeScript decorators. Schemas are inferred from decorated classes at runtime.</p>
<h3 id="decorators" class="tsd-anchor-link">Decorators<a href="#decorators" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The same type functions used to build schemas (<code>StringType()</code>, <code>IntType()</code>, <code>ArrayType()</code>, etc.) also work as property decorators. See <a href="#type-reference">Type Reference</a> for the complete list.</p>
<p><strong>Additional decorator-specific features:</strong></p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>EnumType(&quot;Name&quot;, [])</code></td>
<td>Define an enum type</td>
</tr>
<tr>
<td><code>UnionType(&quot;Name&quot;, [])</code></td>
<td>Define a union from a list of variant classes</td>
</tr>
<tr>
<td><code>ReferenceType(ref)</code></td>
<td>Reference a class, enum, or union</td>
</tr>
</tbody>
</table>
<p><strong>Referencing classes, enums, and unions:</strong></p>
<ul>
<li>Use <code>ReferenceType(ClassName)</code> to reference another class</li>
<li>Use <code>EnumType(&quot;Name&quot;, [...])</code> to define an enum, then <code>ReferenceType(EnumDef)</code> to use it</li>
<li>Use <code>UnionType(&quot;Name&quot;, [ClassA, ClassB])</code> to define a union, then <code>ReferenceType(UnionDef)</code> to use it</li>
</ul>
<h3 id="example" class="tsd-anchor-link">Example<a href="#example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">StringType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">IntType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">UIntType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">FloatType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">BooleanType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">ReferenceType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">ArrayType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">RecordType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">OptionalType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">EnumType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">UnionType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">Infer</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">loadClass</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Enum type</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Team</span><span class="hl-1"> = </span><span class="hl-0">EnumType</span><span class="hl-1">(</span><span class="hl-2">&quot;Team&quot;</span><span class="hl-1">, [</span><span class="hl-2">&quot;RED&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;BLUE&quot;</span><span class="hl-1">]);</span><br/><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-8">Team</span><span class="hl-1"> = </span><span class="hl-8">Infer</span><span class="hl-1">&lt;</span><span class="hl-6">typeof</span><span class="hl-1"> </span><span class="hl-4">Team</span><span class="hl-1">&gt;;</span><br/><br/><span class="hl-5">// Nested object</span><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">Position</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">FloatType</span><span class="hl-1">({ </span><span class="hl-4">precision:</span><span class="hl-1"> </span><span class="hl-9">0.1</span><span class="hl-1"> }) </span><span class="hl-4">x</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">FloatType</span><span class="hl-1">({ </span><span class="hl-4">precision:</span><span class="hl-1"> </span><span class="hl-9">0.1</span><span class="hl-1"> }) </span><span class="hl-4">y</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Union types - define variant classes, then combine with UnionType</span><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">MoveAction</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">IntType</span><span class="hl-1">() </span><span class="hl-4">x</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">IntType</span><span class="hl-1">() </span><span class="hl-4">y</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">AttackAction</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">StringType</span><span class="hl-1">() </span><span class="hl-4">targetId</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> = </span><span class="hl-2">&quot;&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">UIntType</span><span class="hl-1">() </span><span class="hl-4">damage</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Define union type - combines variant classes</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">GameAction</span><span class="hl-1"> = </span><span class="hl-0">UnionType</span><span class="hl-1">(</span><span class="hl-2">&quot;GameAction&quot;</span><span class="hl-1">, [</span><span class="hl-4">MoveAction</span><span class="hl-1">, </span><span class="hl-4">AttackAction</span><span class="hl-1">]);</span><br/><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-8">GameAction</span><span class="hl-1"> = </span><span class="hl-8">Infer</span><span class="hl-1">&lt;</span><span class="hl-6">typeof</span><span class="hl-1"> </span><span class="hl-4">GameAction</span><span class="hl-1">&gt;;</span><br/><br/><span class="hl-5">// Main class</span><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">Player</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">StringType</span><span class="hl-1">() </span><span class="hl-4">id</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> = </span><span class="hl-2">&quot;&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">StringType</span><span class="hl-1">() </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> = </span><span class="hl-2">&quot;&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">IntType</span><span class="hl-1">() </span><span class="hl-4">score</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">BooleanType</span><span class="hl-1">() </span><span class="hl-4">isOnline</span><span class="hl-1">: </span><span class="hl-8">boolean</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  @</span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Position</span><span class="hl-1">) </span><span class="hl-4">position</span><span class="hl-1">: </span><span class="hl-8">Position</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Position</span><span class="hl-1">();</span><br/><span class="hl-1">  @</span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Team</span><span class="hl-1">) </span><span class="hl-4">team</span><span class="hl-1">: </span><span class="hl-8">Team</span><span class="hl-1"> = </span><span class="hl-4">Team</span><span class="hl-1">.</span><span class="hl-7">RED</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  @</span><span class="hl-0">ArrayType</span><span class="hl-1">(</span><span class="hl-0">StringType</span><span class="hl-1">()) </span><span class="hl-4">tags</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">[] = [];</span><br/><span class="hl-1">  @</span><span class="hl-0">ArrayType</span><span class="hl-1">(</span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Position</span><span class="hl-1">)) </span><span class="hl-4">waypoints</span><span class="hl-1">: </span><span class="hl-8">Position</span><span class="hl-1">[] = [];</span><br/><span class="hl-1">  @</span><span class="hl-0">RecordType</span><span class="hl-1">(</span><span class="hl-0">StringType</span><span class="hl-1">(), </span><span class="hl-0">IntType</span><span class="hl-1">()) </span><span class="hl-4">inventory</span><span class="hl-1">: </span><span class="hl-8">Map</span><span class="hl-1">&lt;</span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-8">number</span><span class="hl-1">&gt; = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Map</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  @</span><span class="hl-0">OptionalType</span><span class="hl-1">(</span><span class="hl-0">StringType</span><span class="hl-1">()) </span><span class="hl-4">nickname</span><span class="hl-1">?: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">OptionalType</span><span class="hl-1">(</span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">GameAction</span><span class="hl-1">)) </span><span class="hl-4">lastAction</span><span class="hl-1">?: </span><span class="hl-8">GameAction</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Load API and use</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">PlayerApi</span><span class="hl-1"> = </span><span class="hl-0">loadClass</span><span class="hl-1">(</span><span class="hl-4">Player</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Player</span><span class="hl-1">();</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">name</span><span class="hl-1"> = </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">encoded</span><span class="hl-1"> = </span><span class="hl-4">PlayerApi</span><span class="hl-1">.</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-4">player</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">decoded</span><span class="hl-1"> = </span><span class="hl-4">PlayerApi</span><span class="hl-1">.</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-4">encoded</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Advanced patterns</strong> (nested containers, number modifiers):</p>
<pre><code class="typescript"><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">AdvancedExample</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">ArrayType</span><span class="hl-1">(</span><span class="hl-0">UIntType</span><span class="hl-1">()) </span><span class="hl-4">unsignedInts</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">[] = [];</span><br/><span class="hl-1">  @</span><span class="hl-0">ArrayType</span><span class="hl-1">(</span><span class="hl-0">FloatType</span><span class="hl-1">({ </span><span class="hl-4">precision:</span><span class="hl-1"> </span><span class="hl-9">0.01</span><span class="hl-1"> })) </span><span class="hl-4">floats</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">[] = [];</span><br/><span class="hl-1">  @</span><span class="hl-0">ArrayType</span><span class="hl-1">(</span><span class="hl-0">ArrayType</span><span class="hl-1">(</span><span class="hl-0">IntType</span><span class="hl-1">())) </span><span class="hl-4">matrix</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">[][] = [];</span><br/><span class="hl-1">  @</span><span class="hl-0">RecordType</span><span class="hl-1">(</span><span class="hl-0">StringType</span><span class="hl-1">(), </span><span class="hl-0">ArrayType</span><span class="hl-1">(</span><span class="hl-0">IntType</span><span class="hl-1">())) </span><span class="hl-4">vectorsById</span><span class="hl-1">: </span><span class="hl-8">Map</span><span class="hl-1">&lt;</span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-8">number</span><span class="hl-1">[]&gt; = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Map</span><span class="hl-1">();</span><br/><span class="hl-1">  @</span><span class="hl-0">OptionalType</span><span class="hl-1">(</span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Player</span><span class="hl-1">)) </span><span class="hl-4">partner</span><span class="hl-1">?: </span><span class="hl-8">Player</span><span class="hl-1">; </span><span class="hl-5">// Self-reference</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="working-with-union-types" class="tsd-anchor-link">Working with Union Types<a href="#working-with-union-types" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>With the decorator API, union types are defined using <code>UnionType()</code> to combine variant classes:</p>
<pre><code class="typescript"><span class="hl-5">// Define variant classes (regular decorated classes)</span><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">JoinMessage</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">StringType</span><span class="hl-1">() </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> = </span><span class="hl-2">&quot;&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">InputMessage</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">ClientInput</span><span class="hl-1">) </span><span class="hl-4">input</span><span class="hl-1">: </span><span class="hl-8">ClientInput</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">ClientInput</span><span class="hl-1">();</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Define union type - combines variants</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ClientMessage</span><span class="hl-1"> = </span><span class="hl-0">UnionType</span><span class="hl-1">(</span><span class="hl-2">&quot;ClientMessage&quot;</span><span class="hl-1">, [</span><span class="hl-4">JoinMessage</span><span class="hl-1">, </span><span class="hl-4">InputMessage</span><span class="hl-1">]);</span><br/><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-8">ClientMessage</span><span class="hl-1"> = </span><span class="hl-8">Infer</span><span class="hl-1">&lt;</span><span class="hl-6">typeof</span><span class="hl-1"> </span><span class="hl-4">ClientMessage</span><span class="hl-1">&gt;;</span><br/><br/><span class="hl-5">// Load the API from the union</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ClientMessageApi</span><span class="hl-1"> = </span><span class="hl-0">loadClass</span><span class="hl-1">(</span><span class="hl-4">ClientMessage</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Encoding:</strong> Pass variant class instances directly:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">joinMsg</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">JoinMessage</span><span class="hl-1">();</span><br/><span class="hl-4">joinMsg</span><span class="hl-1">.</span><span class="hl-4">name</span><span class="hl-1"> = </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">encoded</span><span class="hl-1"> = </span><span class="hl-4">ClientMessageApi</span><span class="hl-1">.</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-4">joinMsg</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Decoding:</strong> Returns variant class instances. Use <code>instanceof</code> to narrow the type:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">message</span><span class="hl-1"> = </span><span class="hl-4">ClientMessageApi</span><span class="hl-1">.</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-4">encoded</span><span class="hl-1">);</span><br/><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">message</span><span class="hl-1"> </span><span class="hl-6">instanceof</span><span class="hl-1"> </span><span class="hl-8">JoinMessage</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">.</span><span class="hl-4">name</span><span class="hl-1">); </span><span class="hl-5">// TypeScript knows this is JoinMessage</span><br/><span class="hl-1">} </span><span class="hl-3">else</span><span class="hl-1"> </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">message</span><span class="hl-1"> </span><span class="hl-6">instanceof</span><span class="hl-1"> </span><span class="hl-8">InputMessage</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">message</span><span class="hl-1">.</span><span class="hl-4">input</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="buildschema" class="tsd-anchor-link">buildSchema()<a href="#buildschema" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>If you need access to the generated schema (e.g., for inspection or to use with <code>load()</code> directly), use <code>buildSchema()</code>:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">buildSchema</span><span class="hl-1">, </span><span class="hl-4">load</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">schema</span><span class="hl-1"> = </span><span class="hl-0">buildSchema</span><span class="hl-1">(</span><span class="hl-4">Player</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">schema</span><span class="hl-1">); </span><span class="hl-5">// { Player: { type: &quot;object&quot;, properties: { ... }, name: &quot;Player&quot; } }</span><br/><br/><span class="hl-5">// Use with load() for more control</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">PlayerApi</span><span class="hl-1"> = </span><span class="hl-0">load</span><span class="hl-1">(</span><span class="hl-4">schema</span><span class="hl-1">[</span><span class="hl-2">&quot;Player&quot;</span><span class="hl-1">]);</span>
</code><button type="button">Copy</button></pre>

<h3 id="requirements" class="tsd-anchor-link">Requirements<a href="#requirements" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>tsconfig.json:</strong> Enable <code>&quot;experimentalDecorators&quot;: true</code></p>
<p><strong>Class requirements:</strong></p>
<ol>
<li>Parameterless constructor (instantiable with <code>new Class()</code>)</li>
<li>Decorated properties must have default values (discovered via <code>Object.keys(new Class())</code>)</li>
<li>At least one property must have a type decorator</li>
<li>Unique class names (used as schema identifiers)</li>
</ol>
<p><strong>Note:</strong> Properties without decorators are ignored (not serialized). Methods are also allowed. This lets you add helper methods or transient state to your classes.</p>
<h3 id="api-methods-1" class="tsd-anchor-link">API Methods<a href="#api-methods-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><code>loadClass()</code> returns the same API as <code>load()</code> in interpreter mode:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>encode(obj)</code></td>
<td>Serialize to binary</td>
</tr>
<tr>
<td><code>decode(bytes)</code></td>
<td>Deserialize from binary</td>
</tr>
<tr>
<td><code>encodeDiff(old, new)</code></td>
<td>Encode delta between two states</td>
</tr>
<tr>
<td><code>decodeDiff(old, diff)</code></td>
<td>Apply delta to reconstruct new state</td>
</tr>
<tr>
<td><code>equals(a, b)</code></td>
<td>Deep equality comparison</td>
</tr>
<tr>
<td><code>clone(obj)</code></td>
<td>Deep clone</td>
</tr>
<tr>
<td><code>toJson(obj)</code></td>
<td>Convert to JSON-serializable format</td>
</tr>
<tr>
<td><code>fromJson(obj)</code></td>
<td>Validate and parse JSON data</td>
</tr>
</tbody>
</table>
<p><strong>Key difference:</strong> In decorator mode, <code>decode</code>, <code>decodeDiff</code>, <code>clone</code>, and <code>fromJson</code> return proper class instancesnot plain objects. This includes union variants (e.g., decoding a <code>ClientMessage</code> returns a <code>JoinMessage</code> or <code>InputMessage</code> instance).</p>
<h3 id="schema-api-vs-decorator-api" class="tsd-anchor-link">Schema API vs Decorator API<a href="#schema-api-vs-decorator-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Aspect</th>
<th>Schema API</th>
<th>Decorator API</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type constructors</td>
<td><code>StringType()</code>, <code>ArrayType()</code>, etc.</td>
<td>Same - work as decorators too</td>
</tr>
<tr>
<td>Object types</td>
<td><code>ObjectType(&quot;Name&quot;, { ... })</code></td>
<td>Class with decorated properties</td>
</tr>
<tr>
<td>Enums</td>
<td><code>EnumType(&quot;Name&quot;, [...])</code></td>
<td>Same - <code>EnumType(&quot;Name&quot;, [...])</code></td>
</tr>
<tr>
<td>Unions</td>
<td><code>UnionType(&quot;Name&quot;, [TypeA, TypeB])</code></td>
<td><code>UnionType(&quot;Name&quot;, [ClassA, ClassB])</code></td>
</tr>
<tr>
<td>References</td>
<td>Type references: <code>ReferenceType(PlayerType)</code></td>
<td>Class/enum/union refs: <code>ReferenceType(ref)</code></td>
</tr>
<tr>
<td>Loading</td>
<td><code>load(RootType)</code></td>
<td><code>loadClass(Class)</code> or <code>loadClass(UnionDef)</code></td>
</tr>
<tr>
<td>Return types</td>
<td>Plain objects</td>
<td>Class instances with methods</td>
</tr>
</tbody>
</table>
<h2 id="codegen-api" class="tsd-anchor-link">Codegen API<a href="#codegen-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The codegen mode generates TypeScript code from schemas for compile-time type safety. Code generation is handled by the <code>@hpx7/delta-pack-cli</code> package.</p>
<h3 id="generating-code" class="tsd-anchor-link">Generating Code<a href="#generating-code" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-5"># Install CLI globally or use npx</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-6">-g</span><span class="hl-1"> </span><span class="hl-2">@hpx7/delta-pack-cli</span><br/><br/><span class="hl-5"># Generate from YAML schema</span><br/><span class="hl-0">delta-pack</span><span class="hl-1"> </span><span class="hl-2">generate</span><span class="hl-1"> </span><span class="hl-2">schema.yml</span><span class="hl-1"> </span><span class="hl-6">-l</span><span class="hl-1"> </span><span class="hl-2">typescript</span><span class="hl-1"> </span><span class="hl-6">-o</span><span class="hl-1"> </span><span class="hl-2">generated.ts</span><br/><br/><span class="hl-5"># Or use npx</span><br/><span class="hl-0">npx</span><span class="hl-1"> </span><span class="hl-2">delta-pack</span><span class="hl-1"> </span><span class="hl-2">generate</span><span class="hl-1"> </span><span class="hl-2">schema.yml</span><span class="hl-1"> </span><span class="hl-6">-l</span><span class="hl-1"> </span><span class="hl-2">typescript</span><span class="hl-1"> </span><span class="hl-6">-o</span><span class="hl-1"> </span><span class="hl-2">generated.ts</span>
</code><button type="button">Copy</button></pre>

<p>For programmatic code generation, import from the CLI package:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">codegenTypescript</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack-cli/codegen&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">parseSchemaYml</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">readFileSync</span><span class="hl-1">, </span><span class="hl-4">writeFileSync</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;fs&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">schemaYml</span><span class="hl-1"> = </span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-2">&quot;schema.yml&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;utf8&quot;</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">schema</span><span class="hl-1"> = </span><span class="hl-0">parseSchemaYml</span><span class="hl-1">(</span><span class="hl-4">schemaYml</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">code</span><span class="hl-1"> = </span><span class="hl-0">codegenTypescript</span><span class="hl-1">(</span><span class="hl-4">schema</span><span class="hl-1">);</span><br/><span class="hl-0">writeFileSync</span><span class="hl-1">(</span><span class="hl-2">&quot;generated.ts&quot;</span><span class="hl-1">, </span><span class="hl-4">code</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h3 id="using-generated-code" class="tsd-anchor-link">Using Generated Code<a href="#using-generated-code" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The generated code exports TypeScript types and runtime objects:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Player</span><span class="hl-1">, </span><span class="hl-4">GameState</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./generated&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// TypeScript types are available</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1">: </span><span class="hl-8">Player</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1">,</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">// Runtime objects provide the same API as interpreter mode</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">encoded</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-4">player</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">decoded</span><span class="hl-1"> = </span><span class="hl-4">Player</span><span class="hl-1">.</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-4">encoded</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h3 id="generated-api" class="tsd-anchor-link">Generated API<a href="#generated-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The generated code provides the same methods as interpreter mode:</p>
<ul>
<li><code>Player.fromJson(obj)</code> - Validate and parse JSON data</li>
<li><code>Player.toJson(obj)</code> - Convert to JSON-serializable format</li>
<li><code>Player.encode(obj)</code> - Serialize to binary</li>
<li><code>Player.decode(bytes)</code> - Deserialize from binary</li>
<li><code>Player.encodeDiff(old, new)</code> - Encode delta</li>
<li><code>Player.decodeDiff(old, diff)</code> - Apply delta</li>
<li><code>Player.equals(a, b)</code> - Deep equality</li>
<li><code>Player.clone(obj)</code> - Deep clone object</li>
<li><code>Player.default()</code> - Default instance</li>
</ul>
<h2 id="complete-example" class="tsd-anchor-link">Complete Example<a href="#complete-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="multiplayer-game-state-sync" class="tsd-anchor-link">Multiplayer Game State Sync<a href="#multiplayer-game-state-sync" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Using Interpreter Mode:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">ObjectType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">StringType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">UIntType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">FloatType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">IntType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">EnumType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">ReferenceType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">RecordType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">load</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">Infer</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Define schema types</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Team</span><span class="hl-1"> = </span><span class="hl-0">EnumType</span><span class="hl-1">(</span><span class="hl-2">&quot;Team&quot;</span><span class="hl-1">, [</span><span class="hl-2">&quot;RED&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;BLUE&quot;</span><span class="hl-1">]);</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Position</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;Position&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-0">FloatType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-0">FloatType</span><span class="hl-1">(),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Player</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;Player&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-0">StringType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">username:</span><span class="hl-1"> </span><span class="hl-0">StringType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">team:</span><span class="hl-1"> </span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Team</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Position</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">health:</span><span class="hl-1"> </span><span class="hl-0">UIntType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-0">IntType</span><span class="hl-1">(),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">GameState</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;GameState&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">players:</span><span class="hl-1"> </span><span class="hl-0">RecordType</span><span class="hl-1">(</span><span class="hl-0">StringType</span><span class="hl-1">(), </span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Player</span><span class="hl-1">)),</span><br/><span class="hl-1">  </span><span class="hl-4">round:</span><span class="hl-1"> </span><span class="hl-0">UIntType</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-4">timeRemaining:</span><span class="hl-1"> </span><span class="hl-0">FloatType</span><span class="hl-1">(),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Infer types</span><br/><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-8">GameStateType</span><span class="hl-1"> = </span><span class="hl-8">Infer</span><span class="hl-1">&lt;</span><span class="hl-6">typeof</span><span class="hl-1"> </span><span class="hl-4">GameState</span><span class="hl-1">&gt;;</span><br/><br/><span class="hl-5">// Load API</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">GameStateApi</span><span class="hl-1"> = </span><span class="hl-0">load</span><span class="hl-1">(</span><span class="hl-4">GameState</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Create initial state</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">state1</span><span class="hl-1">: </span><span class="hl-8">GameStateType</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-4">players:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Map</span><span class="hl-1">([</span><br/><span class="hl-1">    [</span><br/><span class="hl-1">      </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      {</span><br/><span class="hl-1">        </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">username:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">team:</span><span class="hl-1"> </span><span class="hl-2">&quot;RED&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">position:</span><span class="hl-1"> { </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1">, </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1"> },</span><br/><span class="hl-1">        </span><span class="hl-4">health:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">0</span><span class="hl-1">,</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    ],</span><br/><span class="hl-1">  ]),</span><br/><span class="hl-1">  </span><span class="hl-4">round:</span><span class="hl-1"> </span><span class="hl-9">1</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">timeRemaining:</span><span class="hl-1"> </span><span class="hl-9">600.0</span><span class="hl-1">,</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">// Updated state (player moved)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">state2</span><span class="hl-1">: </span><span class="hl-8">GameStateType</span><span class="hl-1"> = {</span><br/><span class="hl-1">  ...</span><span class="hl-4">state1</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">players:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Map</span><span class="hl-1">([[</span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, { ...</span><span class="hl-4">state1</span><span class="hl-1">.</span><span class="hl-4">players</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">)!, </span><span class="hl-4">position:</span><span class="hl-1"> { </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-9">105</span><span class="hl-1">, </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-9">102</span><span class="hl-1"> } }]]),</span><br/><span class="hl-1">  </span><span class="hl-4">timeRemaining:</span><span class="hl-1"> </span><span class="hl-9">599.0</span><span class="hl-1">,</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">// Delta encoding</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">diff</span><span class="hl-1"> = </span><span class="hl-4">GameStateApi</span><span class="hl-1">.</span><span class="hl-0">encodeDiff</span><span class="hl-1">(</span><span class="hl-4">state1</span><span class="hl-1">, </span><span class="hl-4">state2</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">reconstructed</span><span class="hl-1"> = </span><span class="hl-4">GameStateApi</span><span class="hl-1">.</span><span class="hl-0">decodeDiff</span><span class="hl-1">(</span><span class="hl-4">state1</span><span class="hl-1">, </span><span class="hl-4">diff</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Using Decorator Mode:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">StringType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">UIntType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">FloatType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">IntType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">ReferenceType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">RecordType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">EnumType</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">Infer</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">loadClass</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Team</span><span class="hl-1"> = </span><span class="hl-0">EnumType</span><span class="hl-1">(</span><span class="hl-2">&quot;Team&quot;</span><span class="hl-1">, [</span><span class="hl-2">&quot;RED&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;BLUE&quot;</span><span class="hl-1">]);</span><br/><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-8">Team</span><span class="hl-1"> = </span><span class="hl-8">Infer</span><span class="hl-1">&lt;</span><span class="hl-6">typeof</span><span class="hl-1"> </span><span class="hl-4">Team</span><span class="hl-1">&gt;;</span><br/><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">Position</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">FloatType</span><span class="hl-1">() </span><span class="hl-4">x</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">FloatType</span><span class="hl-1">() </span><span class="hl-4">y</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">Player</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">StringType</span><span class="hl-1">() </span><span class="hl-4">id</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> = </span><span class="hl-2">&quot;&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">StringType</span><span class="hl-1">() </span><span class="hl-4">username</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> = </span><span class="hl-2">&quot;&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Team</span><span class="hl-1">) </span><span class="hl-4">team</span><span class="hl-1">: </span><span class="hl-8">Team</span><span class="hl-1"> = </span><span class="hl-2">&quot;RED&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Position</span><span class="hl-1">) </span><span class="hl-4">position</span><span class="hl-1">: </span><span class="hl-8">Position</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Position</span><span class="hl-1">();</span><br/><span class="hl-1">  @</span><span class="hl-0">UIntType</span><span class="hl-1">() </span><span class="hl-4">health</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">IntType</span><span class="hl-1">() </span><span class="hl-4">score</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">GameState</span><span class="hl-1"> {</span><br/><span class="hl-1">  @</span><span class="hl-0">RecordType</span><span class="hl-1">(</span><span class="hl-0">StringType</span><span class="hl-1">(), </span><span class="hl-0">ReferenceType</span><span class="hl-1">(</span><span class="hl-4">Player</span><span class="hl-1">)) </span><span class="hl-4">players</span><span class="hl-1">: </span><span class="hl-8">Map</span><span class="hl-1">&lt;</span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-8">Player</span><span class="hl-1">&gt; = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Map</span><span class="hl-1">();</span><br/><span class="hl-1">  @</span><span class="hl-0">UIntType</span><span class="hl-1">() </span><span class="hl-4">round</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">  @</span><span class="hl-0">FloatType</span><span class="hl-1">() </span><span class="hl-4">timeRemaining</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Load API</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">GameStateApi</span><span class="hl-1"> = </span><span class="hl-0">loadClass</span><span class="hl-1">(</span><span class="hl-4">GameState</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Create initial state</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">state1</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">GameState</span><span class="hl-1">();</span><br/><span class="hl-4">state1</span><span class="hl-1">.</span><span class="hl-4">round</span><span class="hl-1"> = </span><span class="hl-9">1</span><span class="hl-1">;</span><br/><span class="hl-4">state1</span><span class="hl-1">.</span><span class="hl-4">timeRemaining</span><span class="hl-1"> = </span><span class="hl-9">600.0</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Player</span><span class="hl-1">();</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1"> = </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">username</span><span class="hl-1"> = </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">team</span><span class="hl-1"> = </span><span class="hl-2">&quot;RED&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">position</span><span class="hl-1">.</span><span class="hl-4">x</span><span class="hl-1"> = </span><span class="hl-9">100</span><span class="hl-1">;</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">position</span><span class="hl-1">.</span><span class="hl-4">y</span><span class="hl-1"> = </span><span class="hl-9">100</span><span class="hl-1">;</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">health</span><span class="hl-1"> = </span><span class="hl-9">100</span><span class="hl-1">;</span><br/><span class="hl-4">state1</span><span class="hl-1">.</span><span class="hl-4">players</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, </span><span class="hl-4">player</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Updated state (player moved)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">state2</span><span class="hl-1"> = </span><span class="hl-4">GameStateApi</span><span class="hl-1">.</span><span class="hl-0">clone</span><span class="hl-1">(</span><span class="hl-4">state1</span><span class="hl-1">);</span><br/><span class="hl-4">state2</span><span class="hl-1">.</span><span class="hl-4">players</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">)!.</span><span class="hl-4">position</span><span class="hl-1">.</span><span class="hl-4">x</span><span class="hl-1"> = </span><span class="hl-9">105</span><span class="hl-1">;</span><br/><span class="hl-4">state2</span><span class="hl-1">.</span><span class="hl-4">players</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">)!.</span><span class="hl-4">position</span><span class="hl-1">.</span><span class="hl-4">y</span><span class="hl-1"> = </span><span class="hl-9">102</span><span class="hl-1">;</span><br/><span class="hl-4">state2</span><span class="hl-1">.</span><span class="hl-4">timeRemaining</span><span class="hl-1"> = </span><span class="hl-9">599.0</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Delta encoding</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">diff</span><span class="hl-1"> = </span><span class="hl-4">GameStateApi</span><span class="hl-1">.</span><span class="hl-0">encodeDiff</span><span class="hl-1">(</span><span class="hl-4">state1</span><span class="hl-1">, </span><span class="hl-4">state2</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">reconstructed</span><span class="hl-1"> = </span><span class="hl-4">GameStateApi</span><span class="hl-1">.</span><span class="hl-0">decodeDiff</span><span class="hl-1">(</span><span class="hl-4">state1</span><span class="hl-1">, </span><span class="hl-4">diff</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Using Codegen Mode:</strong></p>
<p>Create a schema file (<code>game.schema.yml</code>):</p>
<pre><code class="yaml"><span class="hl-5"># yaml-language-server: $schema=https://raw.githubusercontent.com/hpx7/delta-pack/refs/heads/main/schema.json</span><br/><br/><span class="hl-10">Team</span><span class="hl-1">:</span><br/><span class="hl-1">  - </span><span class="hl-11">RED</span><br/><span class="hl-1">  - </span><span class="hl-11">BLUE</span><br/><br/><span class="hl-10">Position</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-10">x</span><span class="hl-1">: </span><span class="hl-11">float</span><br/><span class="hl-1">  </span><span class="hl-6">y</span><span class="hl-1">: </span><span class="hl-11">float</span><br/><br/><span class="hl-10">Player</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-10">id</span><span class="hl-1">: </span><span class="hl-11">string</span><br/><span class="hl-1">  </span><span class="hl-10">username</span><span class="hl-1">: </span><span class="hl-11">string</span><br/><span class="hl-1">  </span><span class="hl-10">team</span><span class="hl-1">: </span><span class="hl-11">Team</span><br/><span class="hl-1">  </span><span class="hl-10">position</span><span class="hl-1">: </span><span class="hl-11">Position</span><br/><span class="hl-1">  </span><span class="hl-10">health</span><span class="hl-1">: </span><span class="hl-11">uint</span><br/><span class="hl-1">  </span><span class="hl-10">score</span><span class="hl-1">: </span><span class="hl-11">int</span><br/><br/><span class="hl-10">GameState</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-10">players</span><span class="hl-1">: </span><span class="hl-11">&lt;string, Player&gt;</span><br/><span class="hl-1">  </span><span class="hl-10">round</span><span class="hl-1">: </span><span class="hl-11">uint</span><br/><span class="hl-1">  </span><span class="hl-10">timeRemaining</span><span class="hl-1">: </span><span class="hl-11">float</span>
</code><button type="button">Copy</button></pre>

<p>Generate the code:</p>
<pre><code class="bash"><span class="hl-0">npx</span><span class="hl-1"> </span><span class="hl-2">delta-pack</span><span class="hl-1"> </span><span class="hl-2">generate</span><span class="hl-1"> </span><span class="hl-2">game.schema.yml</span><span class="hl-1"> </span><span class="hl-6">-l</span><span class="hl-1"> </span><span class="hl-2">typescript</span><span class="hl-1"> </span><span class="hl-6">-o</span><span class="hl-1"> </span><span class="hl-2">generated.ts</span>
</code><button type="button">Copy</button></pre>

<p>Then use the generated code:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">GameState</span><span class="hl-1">, </span><span class="hl-4">Player</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./generated&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// TypeScript types are available at compile time</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">state</span><span class="hl-1">: </span><span class="hl-8">GameState</span><span class="hl-1"> = </span><span class="hl-4">GameState</span><span class="hl-1">.</span><span class="hl-0">default</span><span class="hl-1">();</span><br/><span class="hl-4">state</span><span class="hl-1">.</span><span class="hl-4">players</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">username:</span><span class="hl-1"> </span><span class="hl-2">&quot;Alice&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">team:</span><span class="hl-1"> </span><span class="hl-2">&quot;RED&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">position:</span><span class="hl-1"> { </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1">, </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-4">health:</span><span class="hl-1"> </span><span class="hl-9">100</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">score:</span><span class="hl-1"> </span><span class="hl-9">0</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Same API as interpreter mode</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">encoded</span><span class="hl-1"> = </span><span class="hl-4">GameState</span><span class="hl-1">.</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-4">state</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">decoded</span><span class="hl-1"> = </span><span class="hl-4">GameState</span><span class="hl-1">.</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-4">encoded</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h2 id="performance-tips" class="tsd-anchor-link">Performance Tips<a href="#performance-tips" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="delta-compression" class="tsd-anchor-link">Delta Compression<a href="#delta-compression" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Delta encoding is most effective when:</p>
<ul>
<li>State changes are incremental (only a few fields change per update)</li>
<li>You send updates frequently (e.g., 60 times per second in games)</li>
<li>Objects are medium to large (&gt;50 bytes)</li>
</ul>
<p><strong>Typical bandwidth savings:</strong></p>
<ul>
<li>Position-only updates: 90-95% smaller</li>
<li>Single field changes: 85-90% smaller</li>
<li>Multiple field changes: 70-85% smaller</li>
</ul>
<h3 id="dirty-tracking-with" class="tsd-anchor-link">Dirty Tracking with <code>track()</code><a href="#dirty-tracking-with" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For maximum <code>encodeDiff</code> performance, use <code>track()</code> to automatically track which fields have changed. This allows delta encoding to skip comparison checks entirely:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">track</span><span class="hl-1">, </span><span class="hl-4">clearTracking</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@hpx7/delta-pack&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Wrap state with tracking</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">state</span><span class="hl-1"> = </span><span class="hl-0">track</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">tick:</span><span class="hl-1"> </span><span class="hl-9">0</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">player:</span><span class="hl-1"> { </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-9">0</span><span class="hl-1">, </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-9">0</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-4">players:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Map</span><span class="hl-1">([[</span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, { </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-9">0</span><span class="hl-1">, </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-9">0</span><span class="hl-1"> }]]),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Mutations are automatically tracked</span><br/><span class="hl-4">state</span><span class="hl-1">.</span><span class="hl-4">tick</span><span class="hl-1"> = </span><span class="hl-9">1</span><span class="hl-1">; </span><span class="hl-5">// Marks &quot;tick&quot; dirty</span><br/><span class="hl-4">state</span><span class="hl-1">.</span><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">x</span><span class="hl-1"> = </span><span class="hl-9">100</span><span class="hl-1">; </span><span class="hl-5">// Marks &quot;x&quot; on player, &quot;player&quot; on state</span><br/><span class="hl-4">state</span><span class="hl-1">.</span><span class="hl-4">players</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">)!.</span><span class="hl-4">x</span><span class="hl-1"> = </span><span class="hl-9">50</span><span class="hl-1">; </span><span class="hl-5">// Marks &quot;x&quot; on player, &quot;p1&quot; on players, &quot;players&quot; on state</span><br/><br/><span class="hl-5">// Efficient delta encoding - only changed fields are compared</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">diff</span><span class="hl-1"> = </span><span class="hl-4">GameStateApi</span><span class="hl-1">.</span><span class="hl-0">encodeDiff</span><span class="hl-1">(</span><span class="hl-4">oldState</span><span class="hl-1">, </span><span class="hl-4">state</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Clear tracking for next update cycle</span><br/><span class="hl-0">clearTracking</span><span class="hl-1">(</span><span class="hl-4">state</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Deep tracking:</strong> Changes to nested objects, arrays, and maps automatically propagate up to parents. This works with:</p>
<ul>
<li>Nested objects: <code>state.player.x = 100</code> marks both <code>player.x</code> and <code>state.player</code></li>
<li>Arrays: <code>state.items[0].value = 99</code> marks the item, index 0, and <code>state.items</code></li>
<li>Maps: <code>state.players.get(&quot;p1&quot;)!.x = 50</code> marks the player, key &quot;p1&quot;, and <code>state.players</code></li>
<li>Array methods: <code>push</code>, <code>pop</code>, <code>shift</code>, <code>unshift</code>, <code>splice</code> all mark appropriate indices</li>
</ul>
<p><strong>Game loop pattern:</strong></p>
<pre><code class="typescript"><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">Game</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">private</span><span class="hl-1"> </span><span class="hl-4">state</span><span class="hl-1"> = </span><span class="hl-0">track</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">GameState</span><span class="hl-1">());</span><br/><br/><span class="hl-1">  </span><span class="hl-0">tick</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-5">// Mutations are automatically tracked</span><br/><span class="hl-1">    </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">state</span><span class="hl-1">.</span><span class="hl-4">tick</span><span class="hl-1">++;</span><br/><span class="hl-1">    </span><span class="hl-3">for</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> [</span><span class="hl-7">id</span><span class="hl-1">, </span><span class="hl-7">input</span><span class="hl-1">] </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">inputs</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1"> = </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">state</span><span class="hl-1">.</span><span class="hl-4">players</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-4">id</span><span class="hl-1">)!;</span><br/><span class="hl-1">      </span><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">x</span><span class="hl-1"> += </span><span class="hl-4">input</span><span class="hl-1">.</span><span class="hl-4">vx</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">y</span><span class="hl-1"> += </span><span class="hl-4">input</span><span class="hl-1">.</span><span class="hl-4">vy</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-0">broadcast</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-3">for</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">client</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">clients</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">diff</span><span class="hl-1"> = </span><span class="hl-4">GameStateApi</span><span class="hl-1">.</span><span class="hl-0">encodeDiff</span><span class="hl-1">(</span><span class="hl-4">client</span><span class="hl-1">.</span><span class="hl-4">lastState</span><span class="hl-1">, </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">state</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">client</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-4">diff</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">client</span><span class="hl-1">.</span><span class="hl-4">lastState</span><span class="hl-1"> = </span><span class="hl-4">GameStateApi</span><span class="hl-1">.</span><span class="hl-0">clone</span><span class="hl-1">(</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">state</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-0">clearTracking</span><span class="hl-1">(</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">state</span><span class="hl-1">); </span><span class="hl-5">// Reset for next tick</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>The <code>Tracked&lt;T&gt;</code> type:</strong> The <code>track()</code> function returns a <code>Tracked&lt;T&gt;</code> which recursively adds <code>_dirty</code> sets at every level of the object tree.</p>
<p><strong>When to use tracking:</strong></p>
<ul>
<li>High-frequency updates (e.g., 20-60 times per second)</li>
<li>Large state objects where full comparison is expensive</li>
<li>Mutable state that changes incrementally each tick</li>
</ul>
<p><strong>Manual <code>_dirty</code> (alternative):</strong> You can also set <code>_dirty</code> directly without using <code>track()</code>:</p>
<pre><code class="typescript"><span class="hl-5">// Objects: track changed fields</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">score</span><span class="hl-1"> = </span><span class="hl-9">150</span><span class="hl-1">;</span><br/><span class="hl-4">player</span><span class="hl-1">.</span><span class="hl-4">_dirty</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Set</span><span class="hl-1">([</span><span class="hl-2">&quot;score&quot;</span><span class="hl-1">]);</span><br/><br/><span class="hl-5">// Arrays: track changed indices</span><br/><span class="hl-4">items</span><span class="hl-1">[</span><span class="hl-9">5</span><span class="hl-1">] = </span><span class="hl-4">newItem</span><span class="hl-1">;</span><br/><span class="hl-4">items</span><span class="hl-1">.</span><span class="hl-4">_dirty</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Set</span><span class="hl-1">([</span><span class="hl-9">5</span><span class="hl-1">]);</span><br/><br/><span class="hl-5">// Maps: track changed keys</span><br/><span class="hl-4">players</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">, </span><span class="hl-4">updatedPlayer</span><span class="hl-1">);</span><br/><span class="hl-4">players</span><span class="hl-1">.</span><span class="hl-4">_dirty</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Set</span><span class="hl-1">([</span><span class="hl-2">&quot;p1&quot;</span><span class="hl-1">]);</span>
</code><button type="button">Copy</button></pre>

<p>The <code>_dirty</code> field is:</p>
<ul>
<li><strong>Optional</strong>: If absent, full comparison is performed</li>
<li><strong>Type-safe</strong>: <code>Set&lt;keyof T&gt;</code> for objects, <code>Set&lt;number&gt;</code> for arrays, <code>Set&lt;K&gt;</code> for maps</li>
<li><strong>Included in types</strong>: Both codegen and interpreter types include <code>_dirty</code></li>
<li><strong>Not serialized</strong>: The <code>_dirty</code> field is never encoded in the binary format</li>
</ul>
<h3 id="quantized-floats" class="tsd-anchor-link">Quantized Floats<a href="#quantized-floats" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Use precision for floats to reduce size:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">Position</span><span class="hl-1"> = </span><span class="hl-0">ObjectType</span><span class="hl-1">(</span><span class="hl-2">&quot;Position&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">x:</span><span class="hl-1"> </span><span class="hl-0">FloatType</span><span class="hl-1">({ </span><span class="hl-4">precision:</span><span class="hl-1"> </span><span class="hl-9">0.1</span><span class="hl-1"> }), </span><span class="hl-5">// ~10cm precision</span><br/><span class="hl-1">  </span><span class="hl-4">y:</span><span class="hl-1"> </span><span class="hl-0">FloatType</span><span class="hl-1">({ </span><span class="hl-4">precision:</span><span class="hl-1"> </span><span class="hl-9">0.1</span><span class="hl-1"> }),</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>This enables delta compression to skip encoding unchanged floats even if they differ slightly due to floating-point imprecision.</p>
<h3 id="string-dictionary" class="tsd-anchor-link">String Dictionary<a href="#string-dictionary" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Strings are automatically deduplicated within each encoding operation. Reuse common strings (player IDs, item names, etc.) to benefit from dictionary compression.</p>
<h3 id="map-vs-array" class="tsd-anchor-link">Map vs Array<a href="#map-vs-array" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>Use <code>RecordType</code> (maps) when entities have unique IDs</li>
<li>Use <code>ArrayType</code> when order matters or IDs aren't meaningful</li>
</ul>
<p>Maps enable efficient delta encoding for entity collections (only changed entities are encoded).</p>
<h2 id="examples" class="tsd-anchor-link">Examples<a href="#examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>See the <code>examples/</code> directory for complete examples:</p>
<ul>
<li><code>examples/primitives/</code> - Basic primitive types</li>
<li><code>examples/user/</code> - User profile with unions and optionals</li>
<li><code>examples/game/</code> - Multiplayer game with complex state</li>
</ul>
<p>Each example includes:</p>
<ul>
<li><code>schema.yml</code> - Schema definition</li>
<li><code>state1.json</code>, <code>state2.json</code>, ... - Example states demonstrating delta compression</li>
</ul>
<h2 id="type-reference" class="tsd-anchor-link">Type Reference<a href="#type-reference" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="primitive-types" class="tsd-anchor-link">Primitive Types<a href="#primitive-types" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Function</th>
<th>TypeScript Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>StringType()</code></td>
<td><code>string</code></td>
<td>UTF-8 encoded string</td>
</tr>
<tr>
<td><code>IntType()</code></td>
<td><code>number</code></td>
<td>Variable-length signed integer (zigzag)</td>
</tr>
<tr>
<td><code>IntType({ min })</code></td>
<td><code>number</code></td>
<td>Bounded integer, encoded as unsigned offset</td>
</tr>
<tr>
<td><code>IntType({ min, max })</code></td>
<td><code>number</code></td>
<td>Bounded integer with validation</td>
</tr>
<tr>
<td><code>UIntType()</code></td>
<td><code>number</code></td>
<td>Shorthand for <code>IntType({ min: 0 })</code></td>
</tr>
<tr>
<td><code>FloatType()</code></td>
<td><code>number</code></td>
<td>32-bit IEEE 754 float</td>
</tr>
<tr>
<td><code>FloatType({ precision })</code></td>
<td><code>number</code></td>
<td>Quantized float with specified precision</td>
</tr>
<tr>
<td><code>BooleanType()</code></td>
<td><code>boolean</code></td>
<td>Single bit boolean</td>
</tr>
</tbody>
</table>
<p><strong>Bounded integers:</strong> When <code>min</code> is specified, values are encoded as <code>value - min</code> using unsigned varints, which is more compact for values near the minimum. The <code>max</code> parameter adds validation in <code>fromJson()</code> but doesn't affect encoding.</p>
<h3 id="container-types" class="tsd-anchor-link">Container Types<a href="#container-types" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Function</th>
<th>TypeScript Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ArrayType(T)</code></td>
<td><code>T[]</code></td>
<td>Array of type T</td>
</tr>
<tr>
<td><code>OptionalType(T)</code></td>
<td><code>T | undefined</code></td>
<td>Optional value of type T</td>
</tr>
<tr>
<td><code>RecordType(K, V)</code></td>
<td><code>Map&lt;K, V&gt;</code></td>
<td>Map with key type K and value type V</td>
</tr>
</tbody>
</table>
<h3 id="complex-types" class="tsd-anchor-link">Complex Types<a href="#complex-types" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Function</th>
<th>TypeScript Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ObjectType(&quot;Name&quot;, { ... })</code></td>
<td><code>{ ... }</code></td>
<td>Object with defined properties</td>
</tr>
<tr>
<td><code>EnumType(&quot;Name&quot;, [...])</code></td>
<td>Union of string literals</td>
<td>Enumerated string values</td>
</tr>
<tr>
<td><code>UnionType(&quot;Name&quot;, [...])</code></td>
<td><code>{ _type: string } &amp; T</code></td>
<td>Tagged union of named types</td>
</tr>
<tr>
<td><code>ReferenceType(Type)</code></td>
<td>Named type</td>
<td>Reference to another named type</td>
</tr>
<tr>
<td><code>SelfReferenceType()</code></td>
<td>Self</td>
<td>Reference to the containing type</td>
</tr>
</tbody>
</table>
<h2 id="development" class="tsd-anchor-link">Development<a href="#development" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="running-tests" class="tsd-anchor-link">Running Tests<a href="#running-tests" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">test</span><span class="hl-1">              </span><span class="hl-5"># Run all tests</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">run</span><span class="hl-1"> </span><span class="hl-2">test:coverage</span><span class="hl-1"> </span><span class="hl-5"># Run with coverage report</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">run</span><span class="hl-1"> </span><span class="hl-2">test:ui</span><span class="hl-1">       </span><span class="hl-5"># Open Vitest UI</span>
</code><button type="button">Copy</button></pre>

<h3 id="type-checking" class="tsd-anchor-link">Type Checking<a href="#type-checking" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">run</span><span class="hl-1"> </span><span class="hl-2">typecheck</span>
</code><button type="button">Copy</button></pre>

<h3 id="formatting" class="tsd-anchor-link">Formatting<a href="#formatting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">run</span><span class="hl-1"> </span><span class="hl-2">format</span><span class="hl-1">        </span><span class="hl-5"># Format code</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">run</span><span class="hl-1"> </span><span class="hl-2">format:check</span><span class="hl-1">  </span><span class="hl-5"># Check formatting</span>
</code><button type="button">Copy</button></pre>

<h2 id="api-documentation" class="tsd-anchor-link">API Documentation<a href="#api-documentation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>For detailed API documentation and schema syntax, see the <a href="media/README.md">main README</a>.</p>
<h2 id="license" class="tsd-anchor-link">License<a href="#license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>MIT</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#delta-pack-typescript"><span>Delta-<wbr/>Pack <wbr/>Type<wbr/>Script</span></a><ul><li><a href="#installation"><span>Installation</span></a></li><li><a href="#quick-start"><span>Quick <wbr/>Start</span></a></li><li><ul><li><a href="#interpreter-mode-recommended-for-prototyping"><span>Interpreter <wbr/>Mode (<wbr/>Recommended for prototyping)</span></a></li><li><a href="#decorator-mode-recommended-for-class-based-code"><span>Decorator <wbr/>Mode (<wbr/>Recommended for class-<wbr/>based code)</span></a></li><li><a href="#codegen-mode-recommended-for-production"><span>Codegen <wbr/>Mode (<wbr/>Recommended for production)</span></a></li></ul></li><li><a href="#schema-definition"><span>Schema <wbr/>Definition</span></a></li><li><ul><li><a href="#yaml-schema"><span>YAML <wbr/>Schema</span></a></li><li><a href="#typescript-schema"><span>Type<wbr/>Script <wbr/>Schema</span></a></li></ul></li><li><a href="#interpreter-api"><span>Interpreter <wbr/>API</span></a></li><li><ul><li><a href="#loading-a-schema"><span>Loading a <wbr/>Schema</span></a></li><li><a href="#api-methods"><span>API <wbr/>Methods</span></a></li><li><ul><li><a href="#"><span></span></a></li><li><a href="#-1"><span></span></a></li><li><a href="#-2"><span></span></a></li><li><a href="#-3"><span></span></a></li><li><a href="#-4"><span></span></a></li><li><a href="#-5"><span></span></a></li><li><a href="#-6"><span></span></a></li><li><a href="#-7"><span></span></a></li></ul></li></ul></li><li><a href="#decorator-api"><span>Decorator <wbr/>API</span></a></li><li><ul><li><a href="#decorators"><span>Decorators</span></a></li><li><a href="#example"><span>Example</span></a></li><li><a href="#working-with-union-types"><span>Working with <wbr/>Union <wbr/>Types</span></a></li><li><a href="#buildschema"><span>build<wbr/>Schema()</span></a></li><li><a href="#requirements"><span>Requirements</span></a></li><li><a href="#api-methods-1"><span>API <wbr/>Methods</span></a></li><li><a href="#schema-api-vs-decorator-api"><span>Schema <wbr/>API vs <wbr/>Decorator <wbr/>API</span></a></li></ul></li><li><a href="#codegen-api"><span>Codegen <wbr/>API</span></a></li><li><ul><li><a href="#generating-code"><span>Generating <wbr/>Code</span></a></li><li><a href="#using-generated-code"><span>Using <wbr/>Generated <wbr/>Code</span></a></li><li><a href="#generated-api"><span>Generated <wbr/>API</span></a></li></ul></li><li><a href="#complete-example"><span>Complete <wbr/>Example</span></a></li><li><ul><li><a href="#multiplayer-game-state-sync"><span>Multiplayer <wbr/>Game <wbr/>State <wbr/>Sync</span></a></li></ul></li><li><a href="#performance-tips"><span>Performance <wbr/>Tips</span></a></li><li><ul><li><a href="#delta-compression"><span>Delta <wbr/>Compression</span></a></li><li><a href="#dirty-tracking-with"><span>Dirty <wbr/>Tracking with </span></a></li><li><a href="#quantized-floats"><span>Quantized <wbr/>Floats</span></a></li><li><a href="#string-dictionary"><span>String <wbr/>Dictionary</span></a></li><li><a href="#map-vs-array"><span>Map vs <wbr/>Array</span></a></li></ul></li><li><a href="#examples"><span>Examples</span></a></li><li><a href="#type-reference"><span>Type <wbr/>Reference</span></a></li><li><ul><li><a href="#primitive-types"><span>Primitive <wbr/>Types</span></a></li><li><a href="#container-types"><span>Container <wbr/>Types</span></a></li><li><a href="#complex-types"><span>Complex <wbr/>Types</span></a></li></ul></li><li><a href="#development"><span>Development</span></a></li><li><ul><li><a href="#running-tests"><span>Running <wbr/>Tests</span></a></li><li><a href="#type-checking"><span>Type <wbr/>Checking</span></a></li><li><a href="#formatting"><span>Formatting</span></a></li></ul></li><li><a href="#api-documentation"><span>API <wbr/>Documentation</span></a></li><li><a href="#license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://github.com/hpx7/delta-pack" class="tsd-nav-link">GitHub</a></nav><nav class="tsd-navigation"><a href="modules.html">Delta-Pack - v0.2.8</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
